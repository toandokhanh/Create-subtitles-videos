{% extends "base.html" %} {% block title %} Tạo phụ đề cho video {% endblock %}
{% block content %} {% if session['user'] %}

  {% include "nav.html" %}
  {% endif %} {% with messages = get_flashed_messages() %} {% if messages %}
  {{messages[2]}} {% endif %} {% endwith %}
<br>
<br>
<div class="modal">
  <div class="loading">
    <div class="music-waves-2">
      <span></span>
      <span></span>
      <span></span>
      <span></span>
      <span></span>
      <span></span>
      <span></span>
    </div>
  </div>
</div>
<div class="container">
  <div class="left">
    <div id="wrapper" style="border: 3px solid black;"">
      <form action="{{ url_for('create_srt', filename=filename.split("/")[-1]) }}" method="POST"> 
        <table id="keywords" cellspacing="0" cellpadding="0">
            <thead>
                <tr>
                    <th style="color: #ffffff;">Start time</th>
                    <th style="color: #ffffff;">End time</th>
                    <th style="color: #ffffff;">Text</th>
                </tr>
            </thead>
            <tbody>
                {% for sub in subtitles %}
                <tr>
                  <td><input type="text" name="start_{{ loop.index }}" value="{{ sub.start_time.strftime('%H:%M:%S,%f')[:-3] }}" step="0.001" ></td>
                  <td><input type="text" name="end_{{ loop.index }}" value="{{ sub.end_time.strftime('%H:%M:%S,%f')[:-3] }}" step="0.001" ></td>                  
                  <td><textarea rows="2" cols="30" name="text_{{ loop.index }}" required>{{ sub.text }}</textarea></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <input type="text" name="name_srt" value="{{ srt_name }}" hidden>
        <button style="margin: 0px 250px;cursor: pointer; background-color: #533aa7; color: #ffffff;" class="change"  type="submit">Update subtitle</button>
    </form>        
  </div>
  <form method="POST" enctype="multipart/form-data">
    {{down.hidden_tag()}} {{down.submit2()}}
  </form> 
  </div>
<div class="right">
  <video style="border: 3px solid black;" width="860" height="530" controls>
    <source src="{{url_for('static',filename=filename)}}?v={{timestamp}}" type="video/mp4" />
  </video>
  <a class="change" style="cursor: pointer; background-color: #533aa7; color: #ffffff;" data-name={{filename}} data-nn={{session['nn']}}>
    Switch to the original language
  </a>

  <!-- <div style="color: red">{{session['nn']}}</div> -->
</div>
</div>
<script>
  window.addEventListener('load', function() {
  // Refresh cache
  navigator.serviceWorker.register('/sw.js').then(function(registration) {
      registration.update();
      console.log("debug")
  });
});
</script>
{% endblock %}
